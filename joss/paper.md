---
title: "toughio: Pre- and post-processing Python library for TOUGH"
tags:
    - tough2
    - tough3
    - preprocessing
    - postprocessing
    - io
authors:
    - name: Keurfon Luu
      orcid: 0000-0001-7927-0019
      affiliation: 1
affiliations:
    - name: Energy Geosciences Division, Lawrence Berkeley National Laboratory, Berkeley, CA, USA
      index: 1

date: 3 March 2020
bibliography: paper.bib
---

# Summary

TOUGH is a widely used general purpose numerical simulator designed for fluid and heat flows of multiphase, multicomponent fluid mixtures in porous and fractured media, which has been applied to many real-world problems such as underground geological storage, geothermal reservoir engineering or nuclear waste disposal, to name a few.

When setting up a model, the most time-consuming part is preparing the input data required to run a TOUGH simulation due to its fixed-format input files and the lack of proper built-in meshing tool to model complex geological structures. In addition, TOUGH uses an integral finite-difference (IFD) formulation to solve the coupled fluid and heat flow equations where the mesh is only represented as a set of elements and connections without any reference to a coordinate system usually required for post-processing with common visualization softwares (e.g. ParaView, Tecplot and VisIt).

In the recent years, many softwares have been developed and published to address the lack of pre- and post-processing features of TOUGH codes, mostly in the form of Graphical User Interfaces (GUIs) such as (free) MULgraph, TIM, TOUGH2Viewer, (commercial) Leapfrog, mView or Petrasim. While GUIs provide a convenient working environment since they do not require to have any programming knowledge, users are limited to the features implemented in the softwares and pre- and post-processing outputs are hardly reproducible because of the closed or proprietary formats. Besides, automation of runs or coupled simulations (e.g. with a mechanical simulator) cannot be carried out through a GUI. All of the aforementioned issues can be addressed by using a high level scripting language such as Python.

To our knowledge, only PyTOUGH provides an exhaustive number of features to carry out a complete TOUGH simulation using a scripting language. ``toughio`` shares the same objectives as PyTOUGH i.e. to provide user-friendly tools to pre- and post-process TOUGH simulations, yet with a different approach and philosophy. On the one hand, a PyTOUGH mesh is represented as a *MULGRAPH* geometry where elements can be unstructured horizontally but only layered vertically. It also checks that all the input parameters are valid so that a TOUGH simulation runs smoothly. On the other hand, although it provides basic meshing features, ``toughio`` mostly relies on common external softwares (e.g. Abaqus, FLAC3D, Gmsh, LaGriT) to generate the mesh by importing and converting it to a TOUGH mesh, which also strongly facilitates the coupling of TOUGH with any other simulator that also relies on the same meshing tools. Besides, ``toughio`` is designed to be *just* a TOUGH input and output file reader/writer. It assumes that the user knows what he is doing and does not check the validity of the model parameters (``toughio`` does check the functional arguments).

Figure 1 shows the result of a sample CO<sub>2</sub> sequestration simulation where supercritical CO<sub>2</sub> is continuously injected during 3 years in a reservoir near a fault modeled as a finite-thickness element with high permeability. The model has been entirely set up using ``toughio`` with a mesh generated by Gmsh imported and pre-processed in Python thanks to ``meshio``. Outputs of the TOUGH simulation have been imported and directly visualized in Python thanks to ``pyvista``.

![Example of simulation of CO<sub>2</sub> upward leakage along a fault completely developed with ``toughio``. Mesh has been generated with Gmsh and imported in Python by ``meshio``. Output figure has been prepared and exported by ``pyvista``.](./figures/sample.png)

## References